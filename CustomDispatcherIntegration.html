<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Custom Dispatcher Integration &mdash; SWAP-IT Execution Engine 0.9.9 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="_static/documentation_options.js?v=be50ab7b"></script>
        <script src="_static/doctools.js?v=9a2dae69"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Control Interface" href="ControlInterface.html" />
    <link rel="prev" title="Dispatcher Configuration" href="DispatcherConfiguration.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            SWAP-IT Execution Engine
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="GettingStarted.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="ExecutionEngineLogic.html">Execution Engine Logic</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="Dispatcher.html">Dispatcher Interface</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="ComputationalLogic.html">Computational Logic</a></li>
<li class="toctree-l2"><a class="reference internal" href="DispatcherCallbacks.html">Dispatcher Callbacks</a></li>
<li class="toctree-l2"><a class="reference internal" href="DispatcherConfiguration.html">Dispatcher Configuration</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Custom Dispatcher Integration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#dispatcherconfig-configuration">DispatcherConfig Configuration</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#create-custom-dispatcher-object">Create Custom Dispatcher Object</a></li>
<li class="toctree-l4"><a class="reference internal" href="#hand-over-custom-type-definitions">Hand over custom type definitions</a></li>
<li class="toctree-l4"><a class="reference internal" href="#start-and-running">Start and Running</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#callbacks">Callbacks</a></li>
<li class="toctree-l3"><a class="reference internal" href="#type-mapping">Type Mapping</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pfdl-scheduler-execution-engine">PFDL-Scheduler &lt;-&gt; Execution Engine</a></li>
<li class="toctree-l4"><a class="reference internal" href="#execution-engine-pfdl-scheduler">Execution Engine &lt;-&gt; PFDL-Scheduler</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="ControlInterface.html">Control Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="Glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="Contact.html">Contact</a></li>
<li class="toctree-l1"><a class="reference internal" href="related_projects.html">Related-Projects</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">SWAP-IT Execution Engine</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="Dispatcher.html">Dispatcher Interface</a></li>
      <li class="breadcrumb-item active">Custom Dispatcher Integration</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/CustomDispatcherIntegration.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="custom-dispatcher-integration">
<span id="custom-dispatchers"></span><h1>Custom Dispatcher Integration<a class="headerlink" href="#custom-dispatcher-integration" title="Link to this heading"></a></h1>
<p>The following sections are supposed as a manual on how to link the Execution Engine with custom dispatchers. The provided code explains the linking of the <a class="reference internal" href="index.html#id5"><span class="std std-ref">PFDL Scheduler</span></a>
and must be adjusted correspondingly.</p>
<section id="dispatcherconfig-configuration">
<span id="id1"></span><h2>DispatcherConfig Configuration<a class="headerlink" href="#dispatcherconfig-configuration" title="Link to this heading"></a></h2>
<p>As stated in <a class="reference internal" href="DispatcherConfiguration.html#dispatcher-configuration"><span class="std std-ref">Dispatcher Configuration</span></a>, the <a class="reference internal" href="DispatcherConfiguration.html#dispatcherconfig-class"><span class="std std-ref">DispatcherConfig Class</span></a> provides an interface for custom dispatcher configurations, where the so called
<a class="reference internal" href="DispatcherConfiguration.html#dispatcherinterface-setter-functions"><span class="std std-ref">Table 2: DispatcherInterface Setter functions</span></a> configure the Dispatcher Interface and thus, link the dispatcher with the Execution Engine. The following code snippets show,
how each of these setter functions are called to configure the Execution Engine with the <a class="reference internal" href="index.html#id5"><span class="std std-ref">PFDL Scheduler</span></a>.
The objective is to configure the config_dispatcher function and by doing so, add the required functionality to the <a class="reference internal" href="DispatcherConfiguration.html#dispatcherconfig-class"><span class="std std-ref">DispatcherConfig Class</span></a>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pfdl_scheduler.model.array</span> <span class="kn">import</span> <span class="n">Array</span>
<span class="kn">from</span> <span class="nn">pfdl_scheduler.scheduler</span> <span class="kn">import</span> <span class="n">Scheduler</span><span class="p">,</span> <span class="n">Event</span>
<span class="kn">from</span> <span class="nn">pfdl_scheduler.api.task_api</span> <span class="kn">import</span> <span class="n">TaskAPI</span>
<span class="kn">from</span> <span class="nn">pfdl_scheduler.api.service_api</span> <span class="kn">import</span> <span class="n">ServiceAPI</span>
<span class="kn">from</span> <span class="nn">pfdl_scheduler.model.struct</span> <span class="kn">import</span> <span class="n">Struct</span>

<span class="kn">from</span> <span class="nn">execution_engine_logic.data_types.types</span> <span class="kn">import</span> <span class="n">EngineArray</span><span class="p">,</span> <span class="n">EngineStruct</span>
<span class="kn">from</span> <span class="nn">dispatcher.dispatcher_interface</span> <span class="kn">import</span> <span class="n">DispatcherInterface</span>

<span class="k">class</span> <span class="nc">DispatcherConfig</span><span class="p">:</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dispatcher_object</span> <span class="o">=</span> <span class="n">DispatcherInterface</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">structs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config_dispatcher</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">config_dispatcher</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1">#create and set the instance that will be configured as dispatcher</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dispatcher_object</span><span class="o">.</span><span class="n">set_dispatcher</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span><span class="n">value</span> <span class="ow">in</span> <span class="o">...</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">structs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dispatcher_object</span><span class="o">.</span><span class="n">set_process_parameter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">structs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dispatcher_object</span><span class="o">.</span><span class="n">set_start_dispatcher</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dispatcher_object</span><span class="o">.</span><span class="n">set_running</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dispatcher_object</span><span class="o">.</span><span class="n">set_fire_event_method</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dispatcher_object</span><span class="o">.</span><span class="n">set_interfaces</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dispatcher_object</span><span class="o">.</span><span class="n">set_register_dispatcher_callbacks</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
</pre></div>
</div>
<section id="create-custom-dispatcher-object">
<h3>Create Custom Dispatcher Object<a class="headerlink" href="#create-custom-dispatcher-object" title="Link to this heading"></a></h3>
<p>First, a dispatcher has to be created, in our case the <a class="reference internal" href="index.html#id5"><span class="std std-ref">PFDL Scheduler</span></a>.
To create the corresponding Scheduler Object, three new class variables are added to the DispatcherConfig: self.scheduler
will be the PFDL-Scheduler object. The self.filepath is a path to a pfdl file that should be executed with the scheduler and the
self.dashboard_host_address specifies an URL to connect the <a class="reference internal" href="index.html#id5"><span class="std std-ref">PFDL Scheduler</span></a> with the
<a class="reference external" href="https://github.com/iml130/swap-it-dashboard">SWAP-IT Dashboard</a>. The scheduler is then created with:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">DispatcherConfig</span><span class="p">:</span>

        <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filepath</span><span class="p">,</span> <span class="n">dashboard_host_address</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dispatcher_object</span> <span class="o">=</span> <span class="n">DispatcherInterface</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">filepath</span> <span class="o">=</span> <span class="n">filepath</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dashboard_host_address</span> <span class="o">=</span> <span class="n">dashboard_host_address</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">scheduler</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scheduler</span> <span class="o">=</span> <span class="n">Scheduler</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filepath</span><span class="p">,</span><span class="n">dashboard_host_address</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dashboard_host_address</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dashboard_host_address</span> <span class="k">else</span> <span class="n">Scheduler</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filepath</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">structs</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">config_dispatcher</span><span class="p">()</span>
</pre></div>
</div>
<p>The created self.scheduler variable is the added to the config_dispatcher function:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="o">..</span> <span class="n">code</span><span class="o">-</span><span class="n">block</span><span class="p">::</span> <span class="n">python</span>

<span class="k">class</span> <span class="nc">DispatcherConfig</span><span class="p">:</span>

        <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filepath</span><span class="p">,</span> <span class="n">dashboard_host_address</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dispatcher_object</span> <span class="o">=</span> <span class="n">DispatcherInterface</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">filepath</span> <span class="o">=</span> <span class="n">filepath</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dashboard_host_address</span> <span class="o">=</span> <span class="n">dashboard_host_address</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">scheduler</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scheduler</span> <span class="o">=</span> <span class="n">Scheduler</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filepath</span><span class="p">,</span><span class="n">dashboard_host_address</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dashboard_host_address</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dashboard_host_address</span> <span class="k">else</span> <span class="n">Scheduler</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filepath</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">structs</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">config_dispatcher</span><span class="p">()</span>

        <span class="k">def</span> <span class="nf">config_dispatcher</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dispatcher_object</span><span class="o">.</span><span class="n">set_dispatcher</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">scheduler</span><span class="p">)</span>
            <span class="o">...</span>
</pre></div>
</div>
</section>
<section id="hand-over-custom-type-definitions">
<h3>Hand over custom type definitions<a class="headerlink" href="#hand-over-custom-type-definitions" title="Link to this heading"></a></h3>
<p>Next, the custom data types that are required for the process execution and thus, the creation of the <a class="reference internal" href="DataObject.html#data-object"><span class="std std-ref">Execution Engine Data Object</span></a>. However, since the
PFDL-Scheduler has a custom type format, which is different to the Execution Engine’s data format,
each of the custom types must be mapped to the Execution Engine’s format. Here, two functions are defined to map the corresponding data types.
These functions are presented in section <a class="reference internal" href="#type-mapping"><span class="std std-ref">Type Mapping</span></a>. Consequently, each custom type of the PFDL description
is first mapped to the Execution Engine format, and then added to the self.structs array:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">DispatcherConfig</span><span class="p">:</span>

        <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filepath</span><span class="p">,</span> <span class="n">dashboard_host_address</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dispatcher_object</span> <span class="o">=</span> <span class="n">DispatcherInterface</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">filepath</span> <span class="o">=</span> <span class="n">filepath</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dashboard_host_address</span> <span class="o">=</span> <span class="n">dashboard_host_address</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">scheduler</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scheduler</span> <span class="o">=</span> <span class="n">Scheduler</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filepath</span><span class="p">,</span><span class="n">dashboard_host_address</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dashboard_host_address</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dashboard_host_address</span> <span class="k">else</span> <span class="n">Scheduler</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filepath</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">structs</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">config_dispatcher</span><span class="p">()</span>

        <span class="k">def</span> <span class="nf">config_dispatcher</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dispatcher_object</span><span class="o">.</span><span class="n">set_dispatcher</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">scheduler</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">key</span><span class="p">,</span><span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">scheduler</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">structs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">structs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">PfdlEeDataconverter</span><span class="p">()</span><span class="o">.</span><span class="n">create_ee_format</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dispatcher_object</span><span class="o">.</span><span class="n">set_process_parameter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">structs</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="start-and-running">
<h3>Start and Running<a class="headerlink" href="#start-and-running" title="Link to this heading"></a></h3>
<p>Next, the Execution Engine requires methods to start a process execution with the scheduler and besides, get the running variable
from the scheduler that indicates whether the process execution is completed or not. While the previously configured setter functions
only receives variables and objects as arguments, the Start and Running configuration hand over functions from the scheduler to the
Execution Engine. Here, the function return_running is added to the DispatcherConfig Class:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">DispatcherConfig</span><span class="p">:</span>

        <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filepath</span><span class="p">,</span> <span class="n">dashboard_host_address</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dispatcher_object</span> <span class="o">=</span> <span class="n">DispatcherInterface</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">filepath</span> <span class="o">=</span> <span class="n">filepath</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dashboard_host_address</span> <span class="o">=</span> <span class="n">dashboard_host_address</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">scheduler</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scheduler</span> <span class="o">=</span> <span class="n">Scheduler</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filepath</span><span class="p">,</span><span class="n">dashboard_host_address</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dashboard_host_address</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dashboard_host_address</span> <span class="k">else</span> <span class="n">Scheduler</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filepath</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">structs</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">config_dispatcher</span><span class="p">()</span>

        <span class="k">def</span> <span class="nf">config_dispatcher</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="o">....</span>

        <span class="k">def</span> <span class="nf">return_running</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dispatcher</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">dispatcher</span><span class="o">.</span><span class="n">running</span>
</pre></div>
</div>
<p>Next the set_start_dispatcher and the set_running functions are configured:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">DispatcherConfig</span><span class="p">:</span>

        <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filepath</span><span class="p">,</span> <span class="n">dashboard_host_address</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dispatcher_object</span> <span class="o">=</span> <span class="n">DispatcherInterface</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">filepath</span> <span class="o">=</span> <span class="n">filepath</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dashboard_host_address</span> <span class="o">=</span> <span class="n">dashboard_host_address</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">scheduler</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scheduler</span> <span class="o">=</span> <span class="n">Scheduler</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filepath</span><span class="p">,</span><span class="n">dashboard_host_address</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dashboard_host_address</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dashboard_host_address</span> <span class="k">else</span> <span class="n">Scheduler</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filepath</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">structs</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">config_dispatcher</span><span class="p">()</span>

        <span class="k">def</span> <span class="nf">config_dispatcher</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dispatcher_object</span><span class="o">.</span><span class="n">set_dispatcher</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">scheduler</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">key</span><span class="p">,</span><span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">scheduler</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">structs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">structs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">PfdlEeDataconverter</span><span class="p">()</span><span class="o">.</span><span class="n">create_ee_format</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dispatcher_object</span><span class="o">.</span><span class="n">set_process_parameter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">structs</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dispatcher_object</span><span class="o">.</span><span class="n">set_start_dispatcher</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dispatcher_object</span><span class="o">.</span><span class="n">dispatcher</span><span class="o">.</span><span class="n">start</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dispatcher_object</span><span class="o">.</span><span class="n">set_running</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">return_running</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="callbacks">
<span id="id2"></span><h2>Callbacks<a class="headerlink" href="#callbacks" title="Link to this heading"></a></h2>
<p>The PFDL Scheduler provides callbacks for <a class="reference internal" href="index.html#tasks-and-services"><span class="std std-ref">Tasks and Services</span></a>, as well as da Data Callback. Consequently,
the PFDL-Scheduler deploys all offered callback functions, however, several steps are required
to make the Execution Engine callbacks available to the PFDL Scheduler. First, each callback requires a wrapper function that
ensures that the received input from the scheduler is transformed to an Execution Engine compatible format and in addition,
that the input arguments for the callback functions are extracted from the scheduler objects:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">fire_dispatcher_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">service_uuid</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">scheduler</span><span class="o">.</span><span class="n">fire_event</span><span class="p">(</span><span class="n">Event</span><span class="p">(</span><span class="n">event_type</span><span class="o">=</span><span class="s2">&quot;service_finished&quot;</span><span class="p">,</span>
                               <span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;service_id&quot;</span><span class="p">:</span> <span class="n">service_uuid</span><span class="p">}))</span>

<span class="k">def</span> <span class="nf">task_started_interface</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">task_api</span><span class="p">:</span> <span class="n">TaskAPI</span><span class="p">):</span>
    <span class="n">task_context_uuid</span> <span class="o">=</span> <span class="n">task_api</span><span class="o">.</span><span class="n">uuid</span> <span class="k">if</span> <span class="n">task_api</span><span class="o">.</span><span class="n">task</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;productionTask&quot;</span> <span class="k">else</span> <span class="n">task_api</span><span class="o">.</span><span class="n">task_context</span><span class="o">.</span><span class="n">uuid</span>
    <span class="n">input_parameters</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">map_input_parameters_to_EE</span><span class="p">(</span><span class="n">task_api</span><span class="o">.</span><span class="n">input_parameters</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dispatcher_object</span><span class="o">.</span><span class="n">task_started_callback_wrapper</span><span class="p">(</span><span class="n">task_api</span><span class="o">.</span><span class="n">task</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">task_api</span><span class="o">.</span><span class="n">uuid</span><span class="p">,</span> <span class="n">task_context_uuid</span><span class="p">,</span>
                                                    <span class="n">task_api</span><span class="o">.</span><span class="n">task</span><span class="o">.</span><span class="n">input_parameters</span><span class="p">,</span> <span class="n">input_parameters</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">task_finished_interface</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">task_api</span><span class="p">:</span> <span class="n">TaskAPI</span><span class="p">):</span>
    <span class="n">task_context_uuid</span> <span class="o">=</span> <span class="n">task_api</span><span class="o">.</span><span class="n">uuid</span> <span class="k">if</span> <span class="n">task_api</span><span class="o">.</span><span class="n">task</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;productionTask&quot;</span> <span class="k">else</span> <span class="n">task_api</span><span class="o">.</span><span class="n">task_context</span><span class="o">.</span><span class="n">uuid</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dispatcher_object</span><span class="o">.</span><span class="n">task_finished_callback_wrapper</span><span class="p">(</span><span class="n">task_api</span><span class="o">.</span><span class="n">task</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">task_api</span><span class="o">.</span><span class="n">uuid</span><span class="p">,</span> <span class="n">task_context_uuid</span><span class="p">,</span>
                                                     <span class="n">task_api</span><span class="o">.</span><span class="n">task</span><span class="o">.</span><span class="n">output_parameters</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">service_finished_interface</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">service_api</span><span class="p">:</span> <span class="n">ServiceAPI</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dispatcher_object</span><span class="o">.</span><span class="n">service_finished_callback_wrapper</span><span class="p">(</span><span class="n">service_api</span><span class="o">.</span><span class="n">service</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                                                        <span class="n">service_api</span><span class="o">.</span><span class="n">uuid</span><span class="p">,</span> <span class="n">service_api</span><span class="o">.</span><span class="n">task_context</span><span class="o">.</span><span class="n">uuid</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">service_started_interface</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">service_api</span><span class="p">:</span> <span class="n">ServiceAPI</span><span class="p">):</span>
    <span class="n">input_parameters</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">map_input_parameters_to_EE</span><span class="p">(</span><span class="n">service_api</span><span class="o">.</span><span class="n">input_parameters</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dispatcher_object</span><span class="o">.</span><span class="n">service_started_callback_wrapper</span><span class="p">(</span><span class="n">service_api</span><span class="o">.</span><span class="n">service</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">service_api</span><span class="o">.</span><span class="n">uuid</span><span class="p">,</span> <span class="n">input_parameters</span><span class="p">,</span>
                                                       <span class="n">service_api</span><span class="o">.</span><span class="n">service</span><span class="o">.</span><span class="n">output_parameters</span><span class="p">,</span>
                                                       <span class="n">service_api</span><span class="o">.</span><span class="n">task_context</span><span class="o">.</span><span class="n">uuid</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">data_provider_interface</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">variable_name</span><span class="p">,</span> <span class="n">task_id</span><span class="p">):</span>
    <span class="n">variable_name</span><span class="p">,</span> <span class="n">struct</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dispatcher_object</span><span class="o">.</span><span class="n">provide_parameter_wrapper</span><span class="p">(</span><span class="n">variable_name</span><span class="p">,</span> <span class="n">task_id</span><span class="o">.</span><span class="n">uuid</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">EePfdlConverter</span><span class="p">()</span><span class="o">.</span><span class="n">convert_ee_to_pfdl</span><span class="p">(</span><span class="n">variable_name</span><span class="p">,</span> <span class="n">struct</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">map_input_parameters_to_EE</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_parameter_values</span><span class="p">):</span>
    <span class="n">input_parameters</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">input_parameter_values</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">input_parameter_values</span><span class="p">)):</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">input_parameter_values</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">Struct</span><span class="p">):</span>
                <span class="n">input_parameters</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">PfdlEeDataconverter</span><span class="p">()</span><span class="o">.</span><span class="n">create_ee_format</span><span class="p">(</span><span class="n">input_parameter_values</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">input_parameters</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">input_parameter_values</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">input_parameters</span>
</pre></div>
</div>
<p>The function map_input_parameters_to_EE() is not a callback wrapper,
it only transforms input data structures from the PFDL-scheduler format to the Execution Engine format.</p>
<p>In the second step, a function is required that invokes the register_callback functions of the PFDL-Scheduler and thus,
registers the callback wrappers within the PFDL-Scheduler:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">register_dispatcher_callbacks</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dispatcher_object</span><span class="o">.</span><span class="n">dispatcher</span><span class="o">.</span><span class="n">register_callback_service_started</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">service_started_interface</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dispatcher_object</span><span class="o">.</span><span class="n">dispatcher</span><span class="o">.</span><span class="n">register_callback_service_finished</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">service_finished_interface</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dispatcher_object</span><span class="o">.</span><span class="n">dispatcher</span><span class="o">.</span><span class="n">register_callback_task_started</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">task_started_interface</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dispatcher_object</span><span class="o">.</span><span class="n">dispatcher</span><span class="o">.</span><span class="n">register_callback_task_finished</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">task_finished_interface</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dispatcher_object</span><span class="o">.</span><span class="n">dispatcher</span><span class="o">.</span><span class="n">register_variable_access_function</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_provider_interface</span><span class="p">)</span>
</pre></div>
</div>
<p>As last step, the previously defined functions must be added to the config_dispatcher function, resulting in a
complete integration of the PFDL-Scheduler as Execution Engine Dispatcher:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">DispatcherConfig</span><span class="p">:</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filepath</span><span class="p">,</span> <span class="n">dashboard_host_address</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dispatcher_object</span> <span class="o">=</span> <span class="n">DispatcherInterface</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">filepath</span> <span class="o">=</span> <span class="n">filepath</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dashboard_host_address</span> <span class="o">=</span> <span class="n">dashboard_host_address</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scheduler</span> <span class="o">=</span> <span class="n">Scheduler</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filepath</span><span class="p">,</span><span class="n">dashboard_host_address</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dashboard_host_address</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dashboard_host_address</span> <span class="k">else</span> <span class="n">Scheduler</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filepath</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">structs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config_dispatcher</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">config_dispatcher</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dispatcher_object</span><span class="o">.</span><span class="n">set_dispatcher</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">scheduler</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span><span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">scheduler</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">structs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">structs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">PfdlEeDataconverter</span><span class="p">()</span><span class="o">.</span><span class="n">create_ee_format</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dispatcher_object</span><span class="o">.</span><span class="n">set_process_parameter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">structs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dispatcher_object</span><span class="o">.</span><span class="n">set_start_dispatcher</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dispatcher_object</span><span class="o">.</span><span class="n">dispatcher</span><span class="o">.</span><span class="n">start</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dispatcher_object</span><span class="o">.</span><span class="n">set_running</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">return_running</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dispatcher_object</span><span class="o">.</span><span class="n">set_register_dispatcher_callbacks</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">register_dispatcher_callbacks</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dispatcher_object</span><span class="o">.</span><span class="n">set_fire_event_method</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fire_dispatcher_event</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="type-mapping">
<span id="id3"></span><h2>Type Mapping<a class="headerlink" href="#type-mapping" title="Link to this heading"></a></h2>
<p>As stated before, the PFDL-Scheduler and the Execution Engine define different internal data structures,
so that corresponding mapping functions have to be defined. Here, one maps Execution Engine types to PFDL-Scheduler
types and the second maps the opposite direction.</p>
<section id="pfdl-scheduler-execution-engine">
<h3>PFDL-Scheduler &lt;-&gt; Execution Engine<a class="headerlink" href="#pfdl-scheduler-execution-engine" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">PfdlEeDataconverter</span><span class="p">:</span>

    <span class="k">def</span> <span class="nf">create_ee_format</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">initial_type</span><span class="p">):</span>
        <span class="n">item</span> <span class="o">=</span> <span class="n">EngineStruct</span><span class="p">(</span><span class="n">initial_type</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="n">item</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">convert_to_EE_struct</span><span class="p">(</span><span class="n">initial_type</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span>
        <span class="n">item</span><span class="o">.</span><span class="n">set_struct_type</span><span class="p">(</span><span class="n">initial_type</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">item</span>

    <span class="k">def</span> <span class="nf">convert_array</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">array</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">array</span><span class="o">.</span><span class="n">values</span><span class="p">)):</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">array</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">Struct</span><span class="p">):</span>
                <span class="n">val</span> <span class="o">=</span> <span class="n">EngineStruct</span><span class="p">(</span><span class="n">array</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
                <span class="n">val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">convert_to_EE_struct</span><span class="p">(</span><span class="n">array</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">val</span><span class="p">)</span>
                <span class="n">val</span><span class="o">.</span><span class="n">set_struct_type</span><span class="p">(</span><span class="n">array</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
                <span class="n">item</span><span class="o">.</span><span class="n">add_value</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">array</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">Array</span><span class="p">):</span>
                <span class="n">val</span> <span class="o">=</span> <span class="n">EngineArray</span><span class="p">(</span><span class="n">array</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">array</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">length</span><span class="p">)</span>
                <span class="n">val</span><span class="o">.</span><span class="n">set_array_type</span><span class="p">(</span><span class="n">array</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">data_type</span><span class="p">)</span>
                <span class="n">val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">convert_array</span><span class="p">(</span><span class="n">array</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">val</span><span class="p">)</span>
                <span class="n">item</span><span class="o">.</span><span class="n">add_value</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">item</span><span class="o">.</span><span class="n">add_value</span><span class="p">(</span><span class="n">array</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">item</span>

    <span class="k">def</span> <span class="nf">convert_to_EE_struct</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">struct</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="k">for</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span> <span class="ow">in</span> <span class="n">struct</span><span class="o">.</span><span class="n">attributes</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">Struct</span><span class="p">):</span>
                <span class="n">val</span> <span class="o">=</span> <span class="n">EngineStruct</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
                <span class="n">val</span><span class="o">.</span><span class="n">set_struct_type</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
                <span class="n">val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">convert_to_EE_struct</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span>
                <span class="n">item</span><span class="o">.</span><span class="n">add_attribute</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">Array</span><span class="p">):</span>
                <span class="n">val</span> <span class="o">=</span> <span class="n">EngineArray</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="o">.</span><span class="n">length</span><span class="p">)</span>
                <span class="n">val</span><span class="o">.</span><span class="n">set_array_type</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">type_of_elements</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">val</span><span class="o">.</span><span class="n">data_type</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
                    <span class="n">val</span><span class="o">.</span><span class="n">set_array_type</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
                <span class="n">val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">convert_array</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span>
                <span class="n">item</span><span class="o">.</span><span class="n">add_attribute</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">item</span><span class="o">.</span><span class="n">add_attribute</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">item</span>
</pre></div>
</div>
</section>
<section id="execution-engine-pfdl-scheduler">
<h3>Execution Engine &lt;-&gt; PFDL-Scheduler<a class="headerlink" href="#execution-engine-pfdl-scheduler" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">EePfdlConverter</span><span class="p">:</span>

    <span class="k">def</span> <span class="nf">convert_ee_to_pfdl</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">variable_name</span><span class="p">,</span> <span class="n">server_struct</span><span class="p">):</span>
        <span class="n">variable</span> <span class="o">=</span> <span class="n">Struct</span><span class="p">()</span>
        <span class="n">variable</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">variable_name</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">server_struct</span><span class="p">,</span> <span class="n">EngineStruct</span><span class="p">):</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span> <span class="ow">in</span> <span class="n">server_struct</span><span class="o">.</span><span class="n">attributes</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">bool</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">float</span><span class="p">):</span>
                    <span class="n">variable</span><span class="o">.</span><span class="n">attributes</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">EngineArray</span><span class="p">):</span>
                    <span class="n">vals</span> <span class="o">=</span> <span class="n">Array</span><span class="p">()</span>
                    <span class="n">vals</span><span class="o">.</span><span class="n">length</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">length</span>
                    <span class="n">vals</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">length</span><span class="p">):</span>
                        <span class="n">vals</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">convert_ee_to_pfdl</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
                        <span class="n">variable</span><span class="o">.</span><span class="n">attributes</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">vals</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">variable</span><span class="o">.</span><span class="n">attributes</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">convert_ee_to_pfdl</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">variable</span>
</pre></div>
</div>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="DispatcherConfiguration.html" class="btn btn-neutral float-left" title="Dispatcher Configuration" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="ControlInterface.html" class="btn btn-neutral float-right" title="Control Interface" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Fraunhofer IOSB Author (Florian Düwel).</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(false);
      });
  </script> 

</body>
</html>